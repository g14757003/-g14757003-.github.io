<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¸ æ¡ƒç±³ç¤¾å€æ•…äº‹åœ°åœ–</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        @font-face {
            font-family: 'jf-openhuninn';
            src: url('https://cdn.jsdelivr.net/gh/justfont/open-huninn-font@1.0/font/jf-openhuninn-1.0.ttf');
        }
        :root { --primary-green: #4A6741; --secondary-green: #7ca66e; --text-gray: #444; }
        
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'jf-openhuninn', sans-serif; overflow: hidden; }
        .container { display: flex; height: 100vh; width: 100vw; flex-direction: column; }
        .top-section { display: flex; flex: 1; overflow: hidden; }

        /* å·¦å´å´é‚Šæ¬„ */
        .story-sidebar { width: 300px; height: 100%; overflow: hidden; background: #fff; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 10; display: flex; flex-direction: column; }
        .story-header { padding: 15px; background: var(--primary-green); color: white; flex-shrink: 0; }
        .story-header h1 { margin: 0; font-size: 1.1rem; }
        .plan-description { padding: 12px 15px; background: #fdfdfd; border-bottom: 2px solid var(--secondary-green); font-size: 0.8rem; color: var(--text-gray); line-height: 1.5; flex-shrink: 0; }
        .sidebar-footer { flex: 1; padding: 10px; background: #f9f9f9; display: flex; flex-direction: column; overflow: hidden; }
        .padlet-box { flex: 1; border-radius: 8px; overflow: hidden; border: 1px solid #ddd; background: #fff; }

        /* å³å´åœ°åœ–å€ */
        #map { flex: 1; height: 100%; position: relative; }

        /* å³å´æµ®å‹•é¢æ¿ */
        .map-floating-panel {
            position: absolute; top: 15px; right: 15px; z-index: 1000;
            width: 200px; max-height: 80%; background: rgba(255, 255, 255, 0.95);
            border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            padding: 15px; display: flex; flex-direction: column; gap: 15px;
            transition: transform 0.4s ease; border: 1px solid rgba(0,0,0,0.05);
            overflow-y: auto;
        }
        .map-floating-panel.collapsed { transform: translateX(calc(100% + 30px)); }
        .panel-toggle-btn { position: absolute; top: 15px; right: 15px; z-index: 1001; width: 40px; height: 40px; background: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid #ddd; box-shadow: 0 2px 5px rgba(0,0,0,0.1); font-size: 1.2rem; }
        
        .panel-section { border-top: 1px solid #eee; padding-top: 10px; }
        .panel-title { font-size: 0.85rem; font-weight: bold; color: var(--primary-green); margin-bottom: 8px; display: block; }

        /* å³å´æ™¯é»æ¸…å–® */
        #right-spot-list { display: flex; flex-direction: column; gap: 4px; }
        .right-spot-item { padding: 6px 10px; background: #f8f8f8; border-radius: 4px; font-size: 0.75rem; cursor: pointer; transition: 0.2s; color: #555; }
        .right-spot-item:hover { background: #f0f4ee; color: var(--primary-green); font-weight: bold; }
        
        /* åœ–ä¾‹æ¨£å¼ï¼šåƒ…ä¿ç•™é¡è‰²é» */
        .legend-container { display: flex; flex-direction: column; gap: 6px; }
        .legend-item { font-size: 0.75rem; display: flex; align-items: center; color: #444; }
        .dot { width: 12px; height: 12px; border-radius: 50%; display: inline-block; margin-right: 10px; }

        /* ä¸‹æ–¹è·‘é¦¬ç‡ˆ */
        .carousel-container { height: 130px; background: #fff; border-top: 3px solid var(--secondary-green); overflow: hidden; display: flex; align-items: center; flex-shrink: 0; }
        .carousel-track { display: flex; width: max-content; animation: scroll-loop 45s linear infinite; padding: 10px 0; }
        .carousel-track:hover { animation-play-state: paused; }
        .carousel-item { flex-shrink: 0; margin: 0 15px; width: 150px; cursor: pointer; text-align: center; }
        .carousel-item img { width: 100%; height: 85px; object-fit: cover; border-radius: 10px; transition: 0.3s; border: 2px solid transparent; }
        .carousel-item:hover img { border-color: var(--primary-green); transform: scale(1.05); }
        .carousel-item span { display: block; font-size: 0.8rem; margin-top: 5px; font-weight: bold; }

        @keyframes scroll-loop { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        .popup-content { width: 200px; text-align: center; }
        .popup-content img { width: 100%; height: 110px; object-fit: cover; border-radius: 6px; }
        .nav-link { display: inline-block; padding: 6px 15px; background: var(--primary-green); color: white !important; border-radius: 20px; text-decoration: none; font-size: 0.8rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="top-section">
        <div class="story-sidebar">
            <div class="story-header">
                <h1>ğŸ¸ å—æŠ•æ¡ƒç±³ç¤¾å€äº’å‹•åœ°åœ–ã€‚</h1>
                <p style="margin:0; font-size:0.7rem;">æ¡ƒç±³ç¤¾å€ä½æ–¼å—æŠ•åŸ”é‡Œé®ï¼Œå›  921 åœ°éœ‡å¾Œç©æ¥µæ¨å‹•ç¤¾å€å†é€ è€Œèåï¼Œå±…æ°‘ä»¥ç”Ÿæ…‹ä¿è‚²ç‚ºæ ¸å¿ƒï¼Œçµåˆæ¿•åœ°å¾©è‚²ã€è´è¶èˆ‡è›™é¡æ£²åœ°ç‡Ÿé€ åŠç’°å¢ƒæ•™è‚²ï¼Œé€æ­¥å½¢å¡‘å‡ºå…¼é¡§ç”Ÿæ´»ã€ç”Ÿç”¢èˆ‡ç”Ÿæ…‹çš„æ°¸çºŒè¾²æ‘æ¨£è²Œï¼Œæˆç‚ºè‡ºç£ç¤¾å€ç‡Ÿé€ èˆ‡ç”Ÿæ…‹æ—…éŠçš„é‡è¦å…¸ç¯„ã€‚</p>
            </div>
            <div class="plan-description">
                <b>ğŸ“– è¨ˆç•«èªªæ˜ï¼š</b><br>
                æœ¬ç¶²ç«™é€éå³å´çš„æ™¯é»æ¸…å–®èˆ‡åœ°åœ–æ¨™è¨˜ï¼Œæ‚¨å¯ä»¥é–±è®€åœ°æ™¯çš„æ•…äº‹ï¼›è€Œé€éå·¦å´çš„äº’å‹•ç•™è¨€æ¿ï¼Œæˆ‘å€‘æœŸå¾…æ‚¨æ¨™è¨˜ç•¶ä¸‹çš„è§€å¯Ÿã€ä¸Šå‚³å¯¦æ‹ç…§ç‰‡ï¼Œå°‡æ‚¨çš„å€‹äººæ„Ÿå‹•è½‰åŒ–ç‚ºæ¡ƒç±³å‹•æ…‹å°è¦½çš„ä¸€éƒ¨åˆ†ï¼Œé”æˆã€è§£èªªã€å°å¼•èˆ‡å…¬çœ¾åƒèˆ‡ã€çš„æ°¸çºŒå¾ªç’°ã€‚
            </div>
            <div class="sidebar-footer">
                <h3 style="margin: 0 0 10px 0; font-size: 0.9rem; color: var(--primary-green);">ğŸ’¬ åƒèˆ‡ç•™è¨€æ¿</h3>
                <div class="padlet-box">
                    <iframe src="https://padlet.com/g14757003_1/padlet-yp93nvythk25edzj" style="width:100%;height:100%;border:none;"></iframe>
                </div>
            </div>
        </div>

        <div id="map">
            <div class="panel-toggle-btn" onclick="togglePanel()">âš™ï¸</div>
            <div class="map-floating-panel" id="mainPanel">
                <div style="background: var(--primary-green); color:white; padding: 8px; border-radius: 8px; text-align:center; font-size:0.8rem; cursor:pointer; font-weight:bold;" onclick="locateUser()">ğŸ¯ æˆ‘çš„ä½ç½®</div>
                
                <div class="panel-section">
                    <span class="panel-title">ğŸ¨ åœ°åœ–åœ–ä¾‹</span>
                    <div class="legend-container">
                        <div class="legend-item"><span class="dot" style="background:#2AAD27"></span>è‡ªç„¶ç”Ÿæ…‹</div>
                        <div class="legend-item"><span class="dot" style="background:#2A81CB"></span>äººæ–‡æ–‡åŒ–</div>
                        <div class="legend-item"><span class="dot" style="background:#CB8427"></span>å•†æ¥­æ™¯é»</div>
                    </div>
                </div>

                <div class="panel-section">
                    <span class="panel-title">ğŸ“ æ™¯é»åˆ—è¡¨</span>
                    <div id="right-spot-list"></div>
                </div>

                <div class="panel-section" id="layer-control-container">
                    <span class="panel-title">ğŸ›°ï¸ åœ°åœ–åœ–å±¤</span>
                </div>
            </div>
        </div>
    </div>

    <div class="carousel-container">
        <div class="carousel-track" id="carousel-track"></div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const map = L.map('map', { center: [23.945, 120.928], zoom: 15, zoomControl: false });
    const googleHybrid = L.tileLayer('https://{s}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}', { maxZoom: 20, subdomains: ['mt0', 'mt1', 'mt2', 'mt3'] }).addTo(map);
    const emap = L.tileLayer('https://wmts.nlsc.gov.tw/wmts/EMAP/default/GoogleMapsCompatible/{z}/{y}/{x}', { maxZoom: 19 });

    const icons = {
        eco: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png', shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34] }),
        culture: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png', shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34] }),
        business: L.icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-orange.png', shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34] })
    };

    const spots = [
        { name: "ç´™æ•™å ‚ Paper Dome", pos: [23.941445566032773, 120.92705905326319], type: "culture", desc: "ç´™æ•™å ‚ä»¥ç´™ç®¡çµæ§‹æ‰“é€ ï¼Œèåˆå»ºç¯‰è—è¡“èˆ‡äººæ–‡é—œæ‡·ï¼Œè±¡å¾µéœ‡ç½å¾Œé‡ç”Ÿèˆ‡ç¤¾å€å†ç”Ÿçš„ç²¾ç¥ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2Fea0b4cc0b05d0465c335efa3835c46d6%2FLINE_ALBUM_20251214_251223_57.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xMWLgVn6Fvzo3kUNG_Pfi9T-HxXEdl25Blx-2ea-ErHqgYsqqozJ1L7mVwU9oBaMALa5As0REK9roqpswq8mSbJZ-69ysqh32GNnyE-QVTLp7fbzxmR2SELfwglE8tJjzSTRrET-S0eVX_mV7Uo-y-R" },
        { name: "å¦®å¨œå·§å…‹åŠ›åŸå ¡", pos: [23.943353798683116, 120.92939104762353], type: "business", desc: "å¦®å¨œå·§å…‹åŠ›å¤¢æƒ³åŸå ¡æ˜¯ä¸€åº§åº§è½æ–¼æ¡ƒç±³æ‘ã€å……æ»¿æ­å¼å¤å ¡é¢¨æƒ…çš„è§€å…‰å·¥å» ï¼Œæä¾›éŠå®¢æ²‰æµ¸å¼å…‰é›•äº’å‹•èˆ‡é‡‘ç‰Œå·§å…‹åŠ› DIY çš„è¯éº—æ–‡åŒ–é«”é©—ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_147&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F1a9251a024175397f9f59461986aa670%2FLINE_ALBUM_20251214_251224_34.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xNgJwM4sVAOYkvUVObXdmsetKr3WhQA873oAsYD5NSR8ILknPlk4WlUjA8klmbmUgAAvfFBu-22EO8mhMqD6nXlf3S4BWafZZ3D3hs0P1OJ-2L6RP1tFChYqvyqXRUwz8uG40OOi4viIaHvFmfwVdmq" },
        { name: "æ¡ƒæºåœ‹å°", pos: [23.942098313924028, 120.92590865551838], type: "eco", desc: "å—æŠ•æ¡ƒæºåœ‹å°æ˜¯ä¸€æ‰€åœ¨ 911 éœ‡ç½å¾Œé‡å»ºã€çµåˆæ¡ƒç±³ç”Ÿæ…‹æ‘è³‡æºï¼Œä¸¦æˆåŠŸè½‰å‹ç‚º KIST å¯¦é©—æ•™è‚²çš„éŸŒæ€§å°å­¸ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F2942c33298622bcd4a437064efbfe01a%2FLINE_ALBUM_20251214_251224_76.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xM4ATwJAjyXC2_RcUDzmWwkuTN3sI0HIBzOo8z8kB6mHspKNDn7PfxqAt1QqJlqQWKy2BuoE4UsdKFQxMKacc7YhPQMX8RDtwlTKTJImigWGxfX5R-rTa59Y_JNWWHy1GJR4gXz2NfhAuUdrVPfkR9X" },
        { name: "å¤¢è¶äº­.è¶å¤¢äº­", pos: [23.940870, 120.926613], type: "business", desc: "å¤¢è¶äº­ï¼è¶å¤¢äº­ç‚ºçµåˆè‡ªç„¶ç”Ÿæ…‹èˆ‡äººæ–‡æ„è±¡çš„ä¼‘æ†©æ™¯é»ï¼Œè±¡å¾µæ¡ƒç±³åœ°å€ä»¥è´è¶å¾©è‚²ç‚ºæ ¸å¿ƒçš„ç”Ÿæ…‹ä¿è‚²ç²¾ç¥ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F988c67b8e0192aabf24dd46e423ce2bc%2FLINE_ALBUM_20251214_251223_54.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xOgmMaHX8Kn7dGTvoQaA4ivEat0xn1N-Md09t_YY-xGylDetkmBgVSfOilSCL5iaBSqd_D8qo6XtK_r5z9aDpniB2lbB2j8wv-7ml0UQqpIPyFHqDL8pFVo-dxethgiMqJx9X7yIKSYWgj4CshFDviu" },
        { name: "èˆˆç·£å•†åº—(å•è·¯åº—)", pos: [23.942282, 120.928949], type: "culture", desc: "èˆˆç·£å•†åº—ï¼ˆå•è·¯åº—ï¼‰ç‚ºåœ¨åœ°å±…æ°‘æ—¥å¸¸èšé›†èˆ‡æ—…äººè©¢å•æ–¹å‘çš„é‡è¦æ“šé»ï¼Œå…¼å…·ç”Ÿæ´»æ©Ÿèƒ½èˆ‡ç¤¾å€äº¤æµåŠŸèƒ½ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_147&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F01ec987e8c4cff2a32da308df488f38b%2FLINE_ALBUM_20251214_251224_39.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xMP854w6EiKJwWLLdCB4buweLAPeSUpryVV4r362xgmzTgH5WrYZu3uxLTMqdpeOgYERc3CnerlmXgiHgpMSgpFgKiPejo4qA-B-tpUVaNj5yb1j3SOjDlzYLApT6p8Q7vuC7TlAGMrYduWD6T-7hVH" },
        { name: "æ—¥æ˜¥é¤Šèœ‚åœ’", pos: [23.942266, 120.928851], type: "business", desc: "æ—¥æ˜¥é¤Šèœ‚åœ’è‡´åŠ›æ–¼åœ¨åœ°ç”Ÿç”¢ï¼Œæä¾›å¤©ç„¶ç´”æ­£èœ‚èœœèˆ‡å¤šå…ƒèœ‚ç”¢å“ï¼Œå‚³éå¥åº·èˆ‡åœŸåœ°å…±ç”Ÿçš„ç†å¿µã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_147&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F98a527d7e29772ec027010a7fa69260d%2FLINE_ALBUM_20251214_251224_43.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xNKhcovNOrkMCDqumWLbi6G_2TIEMhAvMAQUCAUWlfTX6IcuNvFX8EvOwda-IoBPJiyx2gPimZbQEbVF8RCd6LThVzW1kvIqazpKl8vRANG8Y0V_KZ3rIuT1FWGVQKjqADC1EwZ4ZcRDcht6iT0hjUR" },
        { name: "åŸ”é‡Œç¦åŒå®®", pos: [23.942621, 120.930764], type: "culture", desc: "åŸ”é‡Œç¦åŒå®®ç‚ºåœ¨åœ°é‡è¦ä¿¡ä»°ä¸­å¿ƒï¼Œä¾›å¥‰åœ°æ–¹å®ˆè­·ç¥ï¼Œæ‰¿è¼‰ç¤¾å€å®—æ•™æ–‡åŒ–èˆ‡æ°‘çœ¾æƒ…æ„Ÿå‡èšã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F1e7b682fdf99f2fa042993445dc743ac%2FLINE_ALBUM_20251214_251224_25.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xMLkit48_1uV9DJ95NVkNc0QZPPBbcGr6EFC4glzgXW7sVIV7bmFsGsGJTghMYVctc4twCBHxlIpbPxF_cTw-nbflBpPlg1ZehVyq6BviT4QNv1kZtLxGwEK1Ly4-ktu5EWRv4w7MVqfiweWInrnZef" },
        { name: "æ¡ƒç±³é›†æœƒæ‰€", pos: [23.942520, 120.930185], type: "culture", desc: "æ¡ƒç±³é›†æœƒæ‰€ç‚ºç¤¾å€å±…æ°‘é›†æœƒã€è¨è«–å…¬å…±äº‹å‹™èˆ‡èˆ‰è¾¦æ´»å‹•çš„é‡è¦ç©ºé–“ï¼Œå‡èšåœ°æ–¹æƒ…æ„Ÿèˆ‡ç¤¾å€å‘å¿ƒåŠ›ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F752505df47e3e33c6e9ee52f87ea9c94%2FLINE_ALBUM_20251214_251224_16.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xMIqgYN8WMPmJ-wdo-cjuIIF4GztKsI5uVJGw2DX4mthxh3qmYn4DLzURmfm95tITp6SHMCIhIGb1vtyHYxuu3_DZpqbL3XH3d5YyC-fVBCijKtN4pKqltAkqHwpObVOt5Xz1Da1MvOoILe6Vsxq4eD" },
        { name: "åŸ”é‡Œæ¡ƒç±³ ç¶ èˆæ°‘å®¿", pos: [23.942567719345284, 120.9269417224301], type: "eco", desc: "åŸ”é‡Œæ¡ƒç±³ç¶ èˆæ°‘å®¿ä»¥å®¶æ±¡å‹å»¢æ°´è™•ç†ç³»çµ±æ‰“é€ ç”Ÿæ…‹æ± ï¼Œé€éè‡ªç„¶æ·¨åŒ–æ©Ÿåˆ¶å¯¦è¸ç’°ä¿ç†å¿µï¼Œå±•ç¾æ°¸çºŒç”Ÿæ´»çš„åœ¨åœ°å¯¦è¸ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_110&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2Ff9b0461cc9aeffaa05a889314860e847%2FLINE_ALBUM_20251214_251224_68.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xPzWOgEiO8W4VBQJZr3XyhnMT-Mgc5U5A1l8zr3NSjNsxpNgBNc1dHQMEN0CA-1pDKxN8xVy0lFtsl6-qL9CIE3E9K3mMLbI6sRRfO-2rkViAQjONUibD5v1fFWMMswQPZfOv_NTSaT1PMtiubeVgY4" },
        { name: "ç”°ä»½ä»”ç”Ÿæ…‹æ± ", pos: [23.940732336049248, 120.92688592346762], type: "eco", desc: "ç”°ä»½ä»”ç”Ÿæ…‹æ± é€éè‡ªç„¶å·¥æ³•ç‡Ÿé€ å¤šæ¨£æ°´åŸŸæ£²åœ°ï¼Œå…¼å…·æ»¯æ´ªã€æ·¨æ°´èˆ‡ç”Ÿæ…‹æ•™è‚²åŠŸèƒ½ï¼Œæ˜¯ç¤¾å€é‡è¦çš„ç”Ÿæ…‹ç¯€é»ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_370%2Cw_278&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2F87e9a542650b191fed1954b438574b97%2FLINE_ALBUM_20251214_251224_105.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xPm8BM9sEd6aeEuXS2dOujB-5IixMVt_aS3aa_4ikI76PqCxz9ze8zYOC_yn4J0S8wiCMvVHWSY1q51R6Qjh3IxLSm_wsl3kgXxNEkJDgNtKczaLTs5VQV8dRFBad7jAWIYigCzpBx-I-K2c6IZ31XX" },
        { name: "æ¡ƒç±³å‘æºªç”Ÿæ…‹æ­¥é“", pos: [23.94311649793645, 120.92884594838682], type: "eco", desc: "æ¡ƒç±³å‘æºªç”Ÿæ…‹æ­¥é“æ²¿æºªè€Œè¡Œï¼Œçµåˆè‡ªç„¶æ™¯è§€èˆ‡ç”Ÿæ…‹è§£èªªï¼Œæä¾›æ°‘çœ¾è¦ªè¿‘æ°´åŸŸã€èªè­˜æ¡ƒç±³ç”Ÿæ…‹ç‰¹è‰²çš„å‹å–„æ­¥è¡Œç©ºé–“ã€‚", img: "https://v1.padlet.pics/3/image.webp?t=c_limit%2Cdpr_1%2Ch_196%2Cw_261&url=https%3A%2F%2Fu1.padletusercontent.com%2Fuploads%2Fpadlet-uploads-usc1%2F4862757000%2Ff65a1f81db0303dc44be72ed3a5fe9f7%2FLINE_ALBUM_20251214_251224_11.jpg%3Fexpiry_token%3D5WaHZRdGG3LkUVQGy3SZ-zdRtq89aJeottSBaF_Hii8dmxJqYDvE2-MDbblcM-ZrVekXW99RReKkJFIoMoKiow26RVdsr6BNjHlBgbo4-xML_RmhC3_hXT4kXstye_qITCnTdtJNlb08u8BL0Bzjq8xSc4exgLqkxHC0ZIZ4BqNMO8p7DBxkIFROrz2rjs3jxaKcjhkW7pUZnnc5gkIKDGg-N23djXJ00qenG5IwUu8_Mv66C-bnpEy3DzdGkGPx" }
    ];

    const markers = [];
    const rightList = document.getElementById('right-spot-list');
    const carouselTrack = document.getElementById('carousel-track');

    spots.forEach((spot, idx) => {
        const marker = L.marker(spot.pos, { icon: icons[spot.type] }).addTo(map);
        marker.bindPopup(`<div class="popup-content"><img src="${spot.img}"><h4>${spot.name}</h4><p style="font-size:0.7rem;">${spot.desc}</p><a href="https://www.google.com/maps/dir/?api=1&destination=${spot.pos[0]},${spot.pos[1]}" target="_blank" class="nav-link">ğŸ§­ å°èˆª</a></div>`);
        markers.push(marker);

        const listItem = document.createElement('div');
        listItem.className = 'right-spot-item';
        listItem.innerHTML = `${spot.name}`;
        listItem.onclick = () => { map.flyTo(spot.pos, 17); setTimeout(() => marker.openPopup(), 1200); };
        rightList.appendChild(listItem);

        const cItem = document.createElement('div');
        cItem.className = 'carousel-item';
        cItem.innerHTML = `<img src="${spot.img}"><span>${spot.name}</span>`;
        carouselTrack.appendChild(cItem);
    });

    const originalContent = carouselTrack.innerHTML;
    carouselTrack.innerHTML = originalContent + originalContent;
    const allCarouselItems = carouselTrack.querySelectorAll('.carousel-item');
    allCarouselItems.forEach((item, index) => {
        const sIndex = index % spots.length;
        item.onclick = () => {
            map.flyTo(spots[sIndex].pos, 17);
            setTimeout(() => markers[sIndex].openPopup(), 1200);
        };
    });

    const layerControl = L.control.layers({ "ğŸ›°ï¸ è¡›æ˜Ÿ": googleHybrid, "ğŸ—ºï¸ é›»å­": emap }, null, { collapsed: false }).addTo(map);
    document.getElementById('layer-control-container').appendChild(layerControl.getContainer());

    function togglePanel() { document.getElementById('mainPanel').classList.toggle('collapsed'); }
    function locateUser() { map.locate({setView: true, maxZoom: 16}); }
    map.on('locationfound', (e) => { L.marker(e.latlng).addTo(map).bindPopup("ğŸ“ æ‚¨åœ¨é€™è£¡").openPopup(); });
</script>
</body>

</html>
